[gd_scene load_steps=18 format=3 uid="uid://c7lheehhbvylp"]

[ext_resource type="Script" uid="uid://ddf0ivure6uik" path="res://entities/mobs/creatures/moth/Moth.cs" id="1_qq40e"]
[ext_resource type="Texture2D" uid="uid://t77v2ar3qs2u" path="res://entities/mobs/creatures/moth/fly.png" id="2_qq40e"]
[ext_resource type="PackedScene" uid="uid://bs3qn0k6qk34k" path="res://components/component_manager/ComponentManager.tscn" id="3_kqcek"]
[ext_resource type="PackedScene" uid="uid://rh1dx2kfkm1n" path="res://components/basic/health/HealthComponent.tscn" id="4_cthkm"]
[ext_resource type="PackedScene" uid="uid://jg6608wf8u7l" path="res://components/basic/contact_damage/ContactDamageComponent.tscn" id="5_ihw6d"]
[ext_resource type="PackedScene" uid="uid://bs00eiy8lhlvg" path="res://components/basic/free_fly/FreeFlyComponent.tscn" id="6_qq40e"]
[ext_resource type="PackedScene" uid="uid://cgxg315s21wev" path="res://components/basic/shader/ShaderComponent.tscn" id="7_48xfr"]
[ext_resource type="Shader" uid="uid://cxksc8qvj1ruc" path="res://shaders/blink.gdshader" id="8_q6o0n"]

[sub_resource type="AtlasTexture" id="AtlasTexture_jyo0l"]
atlas = ExtResource("2_qq40e")
region = Rect2(0, 0, 10, 6)

[sub_resource type="AtlasTexture" id="AtlasTexture_8xt1o"]
atlas = ExtResource("2_qq40e")
region = Rect2(10, 0, 10, 6)

[sub_resource type="AtlasTexture" id="AtlasTexture_48xfr"]
atlas = ExtResource("2_qq40e")
region = Rect2(20, 0, 10, 6)

[sub_resource type="AtlasTexture" id="AtlasTexture_q6o0n"]
atlas = ExtResource("2_qq40e")
region = Rect2(30, 0, 10, 6)

[sub_resource type="SpriteFrames" id="SpriteFrames_r1p3q"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_jyo0l")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_8xt1o")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_48xfr")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_q6o0n")
}],
"loop": true,
"name": &"default",
"speed": 11.0
}]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_5khu5"]
size = Vector2(4, 4)

[sub_resource type="CircleShape2D" id="CircleShape2D_qq40e"]
radius = 22.0227

[sub_resource type="RectangleShape2D" id="RectangleShape2D_q4wwo"]
size = Vector2(4, 4)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_wt63l"]
resource_local_to_scene = true
resource_name = "Blink"
shader = ExtResource("8_q6o0n")
shader_parameter/blink_color = Vector3(1, 1, 1)
shader_parameter/ignore_color = Vector4(0, 0, 0, 1)
shader_parameter/blink_speed = 2.0
shader_parameter/delta_time = 0.0
shader_parameter/run = false

[node name="Moth" type="CharacterBody2D" node_paths=PackedStringArray("FlyAroundPoint", "CM", "Sprite")]
top_level = true
collision_layer = 4
script = ExtResource("1_qq40e")
FlyAroundPoint = NodePath("FlyAroundPoint")
MarginAroundPoint = 10.0
CM = NodePath("ComponentManager")
Team = 1
Sprite = NodePath("AnimatedSprite2D")

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="."]
sprite_frames = SubResource("SpriteFrames_r1p3q")
autoplay = "default"

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource("RectangleShape2D_5khu5")

[node name="FlyAroundPoint" type="Node2D" parent="."]
top_level = true

[node name="DetectionArea" type="Area2D" parent="."]
collision_layer = 0
collision_mask = 2
monitorable = false

[node name="CollisionShape2D" type="CollisionShape2D" parent="DetectionArea"]
shape = SubResource("CircleShape2D_qq40e")

[node name="ComponentManager" parent="." instance=ExtResource("3_kqcek")]

[node name="HealthComponent" parent="ComponentManager" instance=ExtResource("4_cthkm")]

[node name="ContactDamageComponent" parent="ComponentManager" instance=ExtResource("5_ihw6d")]

[node name="CollisionShape2D" parent="ComponentManager/ContactDamageComponent/AttackArea" index="0"]
shape = SubResource("RectangleShape2D_q4wwo")

[node name="FreeFlyComponent" parent="ComponentManager" instance=ExtResource("6_qq40e")]
speed = 75.0
acceleration = 4.31
airResistance = 1.724

[node name="ShaderComponent" parent="ComponentManager" instance=ExtResource("7_48xfr")]
importedShaders = Array[ShaderMaterial]([SubResource("ShaderMaterial_wt63l")])

[connection signal="body_entered" from="DetectionArea" to="." method="onDetectionAreaBodyEntered"]
[connection signal="body_exited" from="DetectionArea" to="." method="onDetectionAreaBodyExited"]

[editable path="ComponentManager/ContactDamageComponent"]
